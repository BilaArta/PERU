<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>

    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">

    <!-- jQuery library -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>

    <!-- Popper JS -->
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script> -->

    <!-- Latest compiled JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>

    <script src="https://cdn.datatables.net/1.10.19/js/jquery.dataTables.min.js"></script>
    <!-- <script src="https://code.jquery.com/jquery-3.3.1.js"></script> -->
    <link rel="stylesheet" href="https://cdn.datatables.net/1.10.19/css/jquery.dataTables.min.css">

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.css">
    <script src="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.js"></script>
    <style>
        body {
            background-color: #f1f2f6
        }
    </style>

</head>

<body>
    <div class="container">
        <ul class="nav nav-black nav-tabs">
            <li class="nav-item">
                <a class="nav-link active" data-toggle="tab" href="#home">PTL</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" data-toggle="tab" href="#menu1">Admin Aktivasi</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" data-toggle="tab" href="#menu2">Admin Aset</a>
            </li>
        </ul>

        <div class="tab-content">
            <div class="tab-pane active" id="home">
                <div class="row">
                    <div class="col-md-12">
                        <h1 class="text-center"><b>DATA SO</b></h1>
                    </div>
                </div>
                <hr>
                <table id="example" class="display" style="width:100%">
                    <button class="btn btn-success" data-toggle="modal" data-target="#dataSo"
                        style="margin-bottom: 12px">TAMBAH DATA</button>

                    <!-- The Modal -->
                    <div class="modal fade bd-example-modal-lg" id="dataSo">
                        <div class="modal-dialog modal-lg">
                            <div class="modal-content">

                                <!-- Modal Header -->
                                <div class="modal-header">
                                    <h4 class="modal-title">TAMBAH DATA SO</h4>
                                    <button type="button" class="close" data-dismiss="modal">×</button>
                                </div>

                                <!-- Modal body -->
                                <div class="modal-body">

                                    <form class="was-validated" method="POST">
                                        <div class="form-group">
                                            <label for="noSo">No SO :</label>
                                            <input type="text" class="form-control" id="noSo" placeholder="" name="noSo"
                                                required>
                                            <div class="valid-feedback">Valid.</div>
                                            <div class="invalid-feedback">Please fill out this field.</div>
                                        </div>
                                        <div class="form-group">
                                            <label>Nama SO :</label>
                                            <input type="text" class="form-control" id="namaSo" placeholder=""
                                                name="namaSo" required>
                                            <div class="valid-feedback">Valid.</div>
                                            <div class="invalid-feedback">Please fill out this field.</div>
                                        </div>
                                        <div class="form-group">
                                            <label for="noPs">No PS :</label>
                                            <input type="text" class="form-control" id="noPs" placeholder="" name="noPs"
                                                required>
                                            <div class="valid-feedback">Valid.</div>
                                            <div class="invalid-feedback">Please fill out this field.</div>
                                        </div>
                                        <div class="form-group">
                                            <label for="noIo">No IO :</label>
                                            <input type="text" class="form-control" id="noIo" placeholder="" name="noIo"
                                                required>
                                            <div class="valid-feedback">Valid.</div>
                                            <div class="invalid-feedback">Please fill out this field.</div>
                                        </div>
                                        <div class="form-group">
                                            <label for="alamat">Alamat :</label>
                                            <input type="text" class="form-control" id="alamat" placeholder=""
                                                name="alamat" required>
                                            <div class="valid-feedback">Valid.</div>
                                            <div class="invalid-feedback">Please fill out this field.</div>
                                        </div>
                                </div>
                                <!-- Modal footer -->
                                <div class="modal-footer">
                                    <button type="button" id="btnSo" class="btn btn-primary">Submit</button>
                                    </form>
                                </div>

                            </div>
                        </div>
                    </div>

                    <thead>
                        <tr>
                            <th>No SO</th>
                            <th>Nama SO</th>
                            <th>No PS</th>
                            <th>No IO</th>
                            <th>Alamat</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr id="listDataSo">

                        </tr>
                    </tbody>
                    <tfoot>
                        <tr>
                            <th>No SO</th>
                            <th>Nama SO</th>
                            <th>No PS</th>
                            <th>No IO</th>
                            <th>Alamat</th>
                        </tr>
                    </tfoot>
                </table>

            </div>
            <div class="tab-pane fade" id="menu1">
                <div class="row">
                    <div class="col-md-12">
                        <h1 class="text-center"><b>DATA ASET</b></h1>
                    </div>
                </div>
                <hr>
                <table id="tableAset" class="display" style="width:100%">
                    <button class="btn btn-success" data-toggle="modal" data-target="#dataAset"
                        style="margin-bottom: 12px">TAMBAH DATA</button>

                    <!-- The Modal -->
                    <div class="modal fade bd-example-modal-lg" id="dataAset">
                        <div class="modal-dialog modal-lg">
                            <div class="modal-content">

                                <!-- Modal Header -->
                                <div class="modal-header">
                                    <h4 class="modal-title">TAMBAH DATA ASET</h4>
                                    <button type="button" class="close" data-dismiss="modal">×</button>
                                </div>
                                <!-- Modal body -->
                                <div class="modal-body">

                                    <form action="/action_page.php" class="was-validated" method="POST">
                                        <div class="form-group">
                                            <label for="uname">Nama POP :</label>
                                            <input type="text" class="form-control" id="uname" placeholder=""
                                                name="uname" required>
                                            <div class="valid-feedback">Valid.</div>
                                            <div class="invalid-feedback">Please fill out this field.</div>
                                        </div>
                                        <div class="form-group">
                                            <label for="pwd">Keterangan :</label>
                                            <input type="text" class="form-control" id="pwd" placeholder="" name="pswd"
                                                required>
                                            <div class="valid-feedback">Valid.</div>
                                            <div class="invalid-feedback">Please fill out this field.</div>
                                        </div>
                                </div>
                                <!-- Modal footer -->
                                <div class="modal-footer">
                                    <button type="submit" class="btn btn-primary">Submit</button>
                                    </form>
                                </div>

                            </div>
                        </div>
                    </div>

                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Position</th>
                            <th>Office</th>
                            <th>Age</th>
                            <th>Start date</th>
                            <th>Salary</th>
                        </tr>
                    </thead>
                    <tbody>

                    </tbody>
                    <tfoot>
                        <tr>
                            <th>Name</th>
                            <th>Position</th>
                            <th>Office</th>
                            <th>Age</th>
                            <th>Start date</th>
                            <th>Salary</th>
                        </tr>
                    </tfoot>
                </table>
            </div>
        </div>


        <script src="https://www.gstatic.com/firebasejs/6.2.4/firebase-app.js"></script>

        <!-- Add Firebase products that you want to use -->
        <script src="https://www.gstatic.com/firebasejs/6.2.4/firebase-auth.js"></script>
        <script src="https://www.gstatic.com/firebasejs/6.2.4/firebase-firestore.js"></script>

        <script>
            const listDataSo = document.querySelector('#listDataSo');


            function getDataSo(doc){
                let namaSo = document.createElement('td');
                let noSo = document.createElement('td');
                let noPs = document.createElement('td');
                let noIs = document.createElement('td');
                let alamat = document.createElement('td');

                noSo.textContent = doc.data().noSo;
                namaSo.textContent = doc.data().namaSo;
                noPs.textContent = doc.data().noPs;
                noIo.textContent = doc.data().noId;
                alamat.textContent = doc.data().alamat;

                listDataSo.appendChild(noSo);
                listDataSo.appendChild(namaSo);
                listDataSo.appendChild(noPs);
                listDataSo.appendChild(noIo);
                listDataSo.appendChild(alamat);
            }
            $(document).ready(() => {
                var firebaseConfig = {
                    apiKey: "{{dataFb.apiKey}}",
                    authDomain: "{{dataFb.authDomain}}",
                    databaseURL: "{{dataFb.databaseURL}}",
                    projectId: "{{dataFb.projectId}}",
                    storageBucket: "{{dataFb.storageBucket}}",
                    messagingSenderId: "{{dataFb.messagingSenderId}}",
                    appId: "{{dataFb.appId}}"
                };
                // Initialize Firebase
                firebase.initializeApp(firebaseConfig);
                const db = firebase.firestore()
                firebase.auth().onAuthStateChanged(function (user) {
                    if (user) {
                        // User is signed in.
                        var displayName = user.displayName;
                        var email = user.email;
                        var emailVerified = user.emailVerified;
                        var photoURL = user.photoURL;
                        var isAnonymous = user.isAnonymous;
                        var uid = user.uid;
                        var providerData = user.providerData;
                        $('#username').val(displayName);
                        name = displayName;
                        console.log(name)
                        console.log(user.displayName)
                        console.log('login state change')

                    } else {
                        console.log(' logout state change')
                    }
                });

                //Retrieving Data

                db.collection("Data SO").get().then(function (querySnapshot) {
                    querySnapshot.forEach(function (doc) {
                        // doc.data() is never undefined for query doc snapshots
                        getDataSo(doc)

                    });
                });

                $('#example, #tableAset, #tablePelanggan, #tablePerangkat, #tablePLT').DataTable();

                $('#btnSo').on('click', () => {
                    var noSo = document.getElementById('noSo').value;
                    var namaSo = $('#namaSo').val();
                    var noPs = $('#noPs').val();
                    var noIo = $('#noIo').val()
                    var alamat = $('#alamat').val()

                    var data = db.collection("Data SO").doc()
                    data.set({
                            noSo: noSo,
                            namaSo: namaSo,
                            noIo: noIo,
                            noPs: noPs,
                            alamat: alamat
                        })
                        .then(function () {
                            console.log("Document successfully written!");
                        })
                        .catch(function (error) {
                            console.error("Error writing document: ", error);
                        });

                })
            })
        </script>

</body>

</html>